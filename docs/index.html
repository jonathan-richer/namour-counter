<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="shortcut icon" href="favicon.png" type="image/png">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<!-- <script type="text/javascript" src="p5.min.js"></script> -->
		<title>Namour Counter</title>
		<style>
			body {
				background-color: rgb(226, 78, 231);
			}

		</style>
	</head>

	<body>
		<h1>Ça fait maintenant <span id="days"></span> jours,
			<span id="hours"></span> heures,
			<span id="minutes"></span> minutes,
			<span id="seconds"></span> secondes que tu m'endures! &#x2764;&#x2665;&#x2764;
		</h1>
		<script type="text/javascript">

			// function setup() {
			// 	createCanvas(200, 200);
			// 	background(0);
			// 	beginShape();
			// 	for (let a = 0; a < TWO_PI; a += PI / 1000) {
			// 		const x = 40000 * ((width / 2) + (16 * sin(a)));
			// 		const y = 40000 * ((height / 2) + (13 * cos(a) - 5 * cos(2 * a) - 2 * cos(3 * a) - cos(4 * a)));
			// 		Math.
			// 		vertex(x, y);
			// 	}
			// 	endShape(CLOSE);
			// 	noLoop();
			// }

			const time = document.getElementById("time");
			const start_date = new Date(2018, 07, 25, 0, 18, 0);
			// const getYears = () => (new Date(Date.now()).getFullYear() - start_date.getUTCFullYear());
			// const getMonths = () => Math.abs(new Date(Date.now()).getMonth() - start_date.getMonth());
			const getDays = time => Math.floor(time / 86400000);
			const getHours = time => Math.floor(((time / 3600000) - 1) % 24);
			const getMinutes = time => Math.floor((time / 60000) % 60);
			const getSeconds = time => Math.floor((time / 1000) % 60);

			const lastDiff = {
				seconds: getSeconds(new Date(Date.now()) - start_date),
				minutes: getMinutes(new Date(Date.now()) - start_date),
				hours: getHours(new Date(Date.now()) - start_date),
				days: getDays(new Date(Date.now()) - start_date)
			}

			const units = {
				SEC: "seconds",
				MIN: "minutes",
				HOUR: "hours",
				DAY: "days"
			};
			const { SEC, MIN, HOUR, DAY } = units;

			const changeText = (units, diff) => {
				const elt = document.getElementById(units);
				switch (units) {
					case SEC:
						elt.innerText = getSeconds(diff).toString();
						break;
					case MIN:
						elt.innerText = getMinutes(diff).toString();
						break;
					case HOUR:
						elt.innerText = getHours(diff).toString();
						break;
					case DAY:
						elt.innerText = getDays(diff).toString();
						break;
				}
				// time.innerText = `Ça fait maintenant ${getYears()} années, ${getMonths()} mois, ${getDays(diff)} jours, ${getHours(diff)} heures, ${getMinutes(diff)} minutes, ${getSeconds(diff)} secondes que tu m'endures! <3`;
			}
			const computeTime = async () => {
				const diff = Date.now() - start_date;
				if (getSeconds(diff) !== lastDiff.seconds) {
					changeText(SEC, diff);
				}
				if (getMinutes(diff) !== lastDiff.minutes) {
					changeText(MIN, diff);
				}
				if (getHours(diff) !== lastDiff.hours) {
					changeText(HOUR, diff);
				}
				if (getDays(diff) !== lastDiff.days) {
					changeText(DAY, diff);
				}
				setTimeout(computeTime, 100);
			};
			for (const unit in units) {
				changeText(units[unit], Date.now() - start_date);
			}
			computeTime();
		</script>
	</body>

</html>
